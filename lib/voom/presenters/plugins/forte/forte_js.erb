<% if comp.env == 'production' %>
  <script type="text/javascript" src="https://api.forte.net/js/v1"></script>
<% else %>
  <script type="text/javascript" src="https://sandbox.forte.net/api/js/v1"></script>
<% end %>

<script>
function createForteToken(_options, params, _event) {
    var data = {
        api_login_id: params.api_login_id,
        account_number: document.getElementById('forte-echeck-account-number-input').value,
        routing_number: document.getElementById('forte-echeck-routing-number-input').value,
        account_type: document.getElementById('forte-echeck-account-type').value
    };

    var prom = new Promise(function (resolve) {
        forte.createToken(data).success(function (response) {
            var token = response.onetime_token;


            /*
        document.getElementById('forte-echeck-onetime-token').value = token;
        var event = new Event('change');
        document.getElementById('forte-echeck-onetime-token').dispatchEvent(event);*/
            resolve({action: 'create_forte_token', content: {data: {token: "FAKETOKEN"}}, statusCode: 200});
        }).error(function (response) {
            alert('failed');
            console.log(response);
        });
    });


    return prom;
}
</script>


